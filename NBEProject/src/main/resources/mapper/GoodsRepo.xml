<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lec.spring.repository.GoodsRepo">
    <select id="selectByCategory" resultType="com.lec.spring.domain.shop.Goods" flushCache="true">
        select g.goods_no, g.category_code, g.name, g.keywords, g.maker, g.price, g.image, g.contents, g.view_cnt
        from goods g, category c
        where g.category_code=c.category_code
            and c.category1=#{param1}
            and c.category2=#{param2}
        limit #{param3}, #{param4}
    </select>

    <select id="getRandomItem" resultType="com.lec.spring.domain.shop.Goods" flushCache="true">
        select * from goods order by rand() limit 5;
    </select>

    <select id="selectById" resultType="com.lec.spring.domain.shop.Goods" flushCache="true">
        select *
        from goods
        where goods_no=#{param1}
    </select>

    <select id="selectByViewCnt" resultType="com.lec.spring.domain.shop.Goods" flushCache="true">
        select *
        from goods
        order by view_cnt desc limit 5;
    </select>

    <select id="countAll" flushCache="true">
        select count(*)
        from goods g, category c
        where g.category_code=c.category_code
        and c.category1=#{param1}
        and c.category2=#{param2}
    </select>

    <update id="plusViewCnt" parameterType="com.lec.spring.domain.shop.Goods">
        update goods set view_cnt=#{viewCnt}
        where goods_no=#{goods_no}
    </update>
</mapper>
